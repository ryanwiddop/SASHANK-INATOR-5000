# Event title
event = "UML NCCDC"

# Show more info to competitors
verbose = true

# Engine settings
timezone = "America/New_York"   # Timezone you want to use
dbpath = ""                        # Path to sqlite3 database (default "dwayne.db")
injectapikey = "superSecretKey1!"  # API key for remotely adding injects
https = true                       # Enable HTTPS
port = 443                         # Port to listen on
cert = "cert/cert.pem"            # Path to cert file
key = "cert/key.pem"              # Path to key file
# disableheadtohead = true           # Hide head to head stats (other than current service status) between competitors
startpaused = false                 # Start the competition paused

# Timing settings
delay = 120               # delay (seconds) between checks (>0) (default 60)
                             # note: the "real" max delay will be timeout+delay+jitter
jitter = 45               # jitter (seconds) between rounds (0<jitter<delay)
timeout = 25              # check timeout (must be smaller than delay-jitter)
servicepoints = 10       # how many points each up check is worth
slathreshold = 6         # how many checks before incurring SLA violation
slapoints = 20           # how many points is an SLA penalty (default slathreshold * 2)

# Mode settings
nopasswords = false      # disables password change requests (like CyberPatriot NSMC)
                             # note: some checks do not support being anonymous.
                             # for example, anonymous ssh wouldn't test anything.
                             # so, you can use a tcp check and just name it 'ssh'.
easypcr = true           # allow easy password changes
disableinfopage = true   # disable the "info" page on the nav header
persists = false         # run in cyberconquest mode (purple team events)

uptime = false           # add client uptime checking (clients must hit /update)
uptimesla = 5           # if uptime, how many minutes can a machine be down before SLA penalty
                             # this SLA value stacks, for example, twenty minutes down is two SLAs

# Admins have access to all records and information.
# You need at least one admin.
[[admin]]
name = "blackteam"
pw = "SimplePassword"

# Each team added here will show up on the scoreboard
# You need at least one team.
[[team]]
ip = "90" # This IP will fill in the x in the box IP address -Ryan
pw = "1qazxsW@1"

# [[team]]
# ip = "91"
# pw = "1qazxsw21"

# [[team]]
# ip = "2"
# pw = "AppleSauce"

# Credlists allow you to have different users for different services
# If none is specified, the first cred list in the config will be used as default


# [[creds]]
# name = "blackteam"
# usernames = ["blackteam"]
# defaultpw = "securepassword"

[[creds]]
name = "rox-ssh1" # Roxxon DB
usernames = ["Frank", "Bertha", "Leslie", "Alex"]
defaultpw = "cheese"

[[creds]]
name = "rox-ssh2" # Roxxon Backups
usernames = ["Charlie", "Amanda", "Ashley", "Robert"]
defaultpw = "redsox"

[[creds]]
name = "blackteam-mail-rox" # Roxxon POP3/SMTP
usernames = ["blackteam@fake-roxxon.com"]
defaultpw = "SimplePassword"

[[creds]]
name = "hydra-ssh1" # HR-Hydra AD/DHCP
usernames = ["William", "Andrea", "Melissa", "Austin"]
defaultpw = "abcd1234"

[[creds]]
name = "blackteam-mail-hr" # HR-Hydra POP3/SMTP
usernames = ["blackteam@hrHydra.com"]
defaultpw = "SimplePassword"



# Box configurations

# Each box is a machine. Service checks exist within each machines box -Ryan
# Order is by IPs ascending
[[box]]
name = "HR-Hydra DNS"
ip = "10.x.x.50"
    [[box.dns]]
    display = "hydra-dns"
    port = 53
        # [[box.dns.record]]
        # kind = "A" # Address record
        # domain = "hydraPills.com"
        # answer = ["10.90.90.",]

        [[box.dns.record]]
        kind = "A" # Address record
        domain = "research.hydraPills.com"
        answer = ["10.90.90.60",]

        [[box.dns.record]]
        kind = "A" # Address record
        domain = "umbrella.hydraPills.com"
        answer = ["10.90.90.55",]

        [[box.dns.record]]
        kind = "A" # Address record
        domain = "antivirus.hydraPills.com"
        answer = ["10.90.90.51",]

        # [[box.dns.record]]
        # kind = "A" # Address record
        # domain = "intrepid.com"
        # answer = ["10.90.90.61",]

        # [[box.dns.record]]
        # kind = "A" # Address record
        # domain = "jockey.com"
        # answer = ["10.90.90.61",]

        # [[box.dns.record]]
        # kind = "A" # Address record
        # domain = "kwikecare.com"
        # answer = ["10.90.90.62",]

        # [[box.dns.record]]
        # kind = "A" # Address record
        # domain = "kwikepills.com"
        # answer = ["10.90.90.62",]

        # [[box.dns.record]]
        # kind = "A" # Address record
        # domain = "jci.com"
        # answer = ["10.90.90.62",]

        # [[box.dns.record]]
        # kind = "A" # Address record
        # domain = "hydra.com"
        # answer = ["10.90.90.55",]

        # [[box.dns.record]]
        # kind = "A" # Address record
        # domain = "corp.com"
        # answer = ["10.90.90.53",]

        # [[box.dns.record]]
        # kind = "MX" # Mail server
        # domain = "hrHydra.com"
        # answer = ["10.90.90.51", "mail.hrHydra.com",] 

[[box]]
name = "HR-Hydra POP3/SMTP"
ip = "10.x.x.51"
    [[box.cmd]]
    display = "hydra-pop3"
    credlists = ["blackteam-mail-hr",]
    # BOXIP and USERNAME and PASSWORD are replaced with their values when run
    command = "python3 checks/pop3.py BOXIP USERNAME PASSWORD" # Keywords not required
    regex = "succeeded with blackteam@hrHydra.com"


    [[box.smtp]]
    display = "hydra-smtp"
    credlists = ["blackteam-mail-hr",]
    sender = "blackteam@hrHydra.com"
    receiver = "tuck@hrHydra.com"
    body = "howdy, friar! he's about to have an outlaw for an inlaw!"

[[box]]
name = "HR-Hydra AD/DHCP"
ip = "10.x.x.52"
    [[box.ssh]]
    display = "hydra1-ssh"
    credlists = ["hydra-ssh1",]
    badattempts = 2
        [[box.ssh.command]]
        command = "more C:\\Web-Materials\\qwickpills\\index.htm | findstr drugs"
        contains = true
        output = "conhost.exe"

[[box]]
name = "HR-Hydra CA/IIS"
ip = "10.x.x.53"
    [[box.web]]
    display = "corp-http"
    scheme = "http"
        [[box.web.url]]
        path = "/corp"

[[box]]
name = "HR-Hydra Zulip 1"
ip = "10.x.x.55"
    [[box.web]]
    display = "hydra-http"
    scheme = "http"
        [[box.web.url]]
        path = "/login.jsp"
        regex = "jive-form-items"

[[box]]
name = "HR-Hydra Zulip 1"
ip = "10.x.x.56"
    [[box.cmd]]
    display = "spark-http"
    command = "curl -X 'GET' 'http://10.90.90.55/plugins/restapi/v1/system/statistics/sessions' -H 'accept: application/xml' -H 'Authorization: eYFdpokYPbTYpiCj'"
    regex = "localSessions>[1-9][0-9]?|^100<"
    

    # [[box.web]]
    # display = "spark-http"
    # scheme = "http"
    #     [[box.web.url]]
    #     path = "/login.jsp"
    #     regex = "jive-form-items"

# [[box]]
# name = "HR-Hydra Zulip 2"
# ip = "10.x.x.60"
#     [[box.web]]
#     display = "gomommy-http"
#     scheme = "http"
#         [[box.web.url]]
#         path = "/GoMommy"

#     [[box.web]]
#     display = "malachor-http"
#     scheme = "http"
#         [[box.web.url]]
#         path = "/Malachor"

#     [[box.web]]
#     display = "hrodin-http"
#     scheme = "http"
#         [[box.web.url]]
#         path = "/HRodin"

[[box]]
name = "HR-Hydra Wordpress 2"
ip = "10.x.x.61"
    [[box.web]]
    display = "grand-http"
    scheme = "http"
        [[box.web.url]]
        path = "/Grand"

    [[box.web]]
    display = "intrepid-http"
    scheme = "http"
        [[box.web.url]]
        path = "/intrepid"

    [[box.web]]
    display = "jockey-http"
    scheme = "http"
        [[box.web.url]]
        path = "/jockey"

[[box]]
name = "HR-Hydra IIS 2"
ip = "10.x.x.62"
    [[box.web]]
    display = "kwikecare-http"
    scheme = "http"
        [[box.web.url]]
        path = "/kwikecare"

    [[box.web]]
    display = "kwikepills-http"
    scheme = "http"
        [[box.web.url]]
        path = "/kwikepills"

    [[box.web]]
    display = "jci-http"
    scheme = "http"
        [[box.web.url]]
        path = "/JCI"

[[box]]
name = "Roxxon Help Desk"
ip = "172.16.x.30"
    [[box.web]]
    display = "roxhelp-http"
    scheme = "http"
	[[box.web.url]]
	path = "/roxhelp"

[[box]]
name = "Roxxon DNS"
ip = "172.16.x.5"
    [[box.dns]]
    display = "rox-dns"
    port = 53
        [[box.dns.record]]
        kind = "A" # Address record
        domain = "thor.com"
        answer = ["172.16.90.76",]

        [[box.dns.record]]
        kind = "A" # Address record
        domain = "loki.com"
        answer = ["172.16.90.76",]

        [[box.dns.record]]
        kind = "A" # Address record
        domain = "odin.com"
        answer = ["172.16.90.76",]

        [[box.dns.record]]
        kind = "A" # Address record
        domain = "zeus.com"
        answer = ["172.16.90.77",]

        [[box.dns.record]]
        kind = "A" # Address record
        domain = "hermes.com"
        answer = ["172.16.90.77",]

        [[box.dns.record]]
        kind = "A" # Address record
        domain = "kronos.com"
        answer = ["172.16.90.77",]

        # [[box.dns.record]]
        # kind = "A" # Address record
        # domain = "oscorp.com"
        # answer = ["172.16.90.80",]

        # [[box.dns.record]]
        # kind = "MX" # Mail server
        # domain = "fake-roxxon.com"
        # answer = ["172.16.90.10", "mail.fake-roxxon.com",] 

[[box]]
name = "Roxxon POP3/SMTP"
ip = "172.16.x.10"
    [[box.cmd]]
    display = "rox-pop3"
    credlists = ["blackteam-mail-rox",]
    # BOXIP and USERNAME and PASSWORD are replaced with their values when run
    command = "python3 checks/pop3.py BOXIP USERNAME PASSWORD" # Keywords not required
    regex = "succeeded with blackteam@fake-roxxon.com"

    [[box.smtp]]
    display = "rox-smtp"
    credlists = ["blackteam-mail-rox",]
    sender = "blackteam@fake-roxxon.com"
    receiver = "larry@fake-roxxon.com"
    body = "i hate dwayne"

[[box]]
name = "Roxxon E-Commerce" 
ip = "172.16.x.20"
    [[box.web]]
    display = "rox-http"
    scheme = "http"
        [[box.web.url]]
        path = "/rox"

[[box]]
name = "Roxxon HRM" 
ip = "172.16.x.25"
    [[box.web]]
    display = "roxhrm-http"
    scheme = "http"
        [[box.web.url]]
        path = ""
        regex = "" # TODO CURL THEN ADD RANDOM HERE


    # [[box.cmd]]
    # display = "roxhrm-http"
    # command = "curl -s -L BOXIP | grep http://www.facebook.com/OrangeHRM"
    # regex = "http://www.facebook.com/OrangeHRM" # Random value from the html to find

[[box]]
name = "Roxxon DB"
ip = "172.16.x.70"
    [[box.ssh]]
    display = "rox1-ssh"
    credlists = ["rox-ssh1",]
    badattempts = 2
        [[box.ssh.command]]
        command = "cat /etc/passwd"
        contains = true
        output = "blackteam:"

[[box]]
name = "Roxxon Wordpress 1"
ip = "172.16.x.35"
    [[box.web]]
    display = "odoo-http"
    port = 8069
    scheme = "http"
        [[box.web.url]]
        path = "/Odoo"

[[box]]
name = "Roxxon Clients" 
ip = "172.16.x.75"
    [[box.ping]]
    display = "clients-ping"
    count = 3 # default 1
    allowpacketloss = true # default false
    percent = 50 # max percent packet loss

[[box]]
name = "Roxxon Gold Clients" 
ip = "172.16.x.76"
    [[box.web]]
    display = "loki-http"
    scheme = "http"
        [[box.web.url]]
        path = "/loki/"
        regex = "<h1>Welcome to Loki.com</h1>"

   [[box.web]]
    display = "odin-http"
    scheme = "http"
        [[box.web.url]]
        path = "/odin/"
        regex = "<h1>Welcome to Odin.com</h1>"

   [[box.web]]
    display = "thor-http"
    scheme = "http"
        [[box.web.url]]
        path = "/thor/"
        regex = "<h1>Welcome to Thor.com</h1>"

[[box]]
name = "Roxxon Platinum Clients" 
ip = "172.16.x.77"
    [[box.web]]
    display = "zeus-http"
    scheme = "http"
        [[box.web.url]]
        path = "/zeus/"
        regex = "<h1>Welcome to Zeus.com</h1>"

   [[box.web]]
    display = "kronos-http"
    scheme = "http"
        [[box.web.url]]
        path = "/kronos/"
        regex = "<h1>Welcome to Kronos.com</h1>"

   [[box.web]]
    display = "hermes-http"
    scheme = "http"
        [[box.web.url]]
        path = "/hermes/"
        regex = "<h1>Welcome to Hermes.com</h1>"

# [[box]]
# name = "Roxxon OSCorp" 
# ip = "172.16.x.80"
#     [[box.web]]
#     display = "oscorp-http"
#     scheme = "http"
#         [[box.web.url]]
#         path = "/oscorp"

[[box]]
name = "Roxxon Backups"
ip = "172.16.x.187"
    [[box.ssh]]
    display = "rox2-ssh"
    credlists = ["rox-ssh2",]
    badattempts = 2
        [[box.ssh.command]]
        command = "cat /etc/passwd"
        contains = true
        output = "blackteam:"

# [[box]]
# name = "Template"
# # x will be replaced by team IP
# ip = "172.16.x.1"

#     # If you want to keep something default, just don't specify it
#     # For this box, we're running default SMB and SSH login checks
#     # [[box.smb]]
#     # [[box.ssh]]

#     # Run command with sh, compare output against regex.
#     # Command must return exit code 0 to pass.
#     [[box.cmd]]
#     # BOXIP and USERNAME and PASSWORD are replaced with their values when run
#     command = "python3 ./test.py BOXIP USERNAME PASSWORD" # Keywords not required
#     regex = "success"

#     # If you omit a value, it is set to the default
#     # For example, if I removed the line port = 4000,
#     # the check port would be 53
#     [[box.dns]]
#     port = 4000 # default 53
#         [[box.dns.record]]
#         kind = "A" # DNS record type
#         domain = "townsquare.sherwood.lan" # Domain query
#         answer = ["192.168.1.4",] # List of acceptable answers

#         [[box.dns.record]]
#         kind = "MX"
#         domain = "sherwood.lan"
#         answer = ["192.168.1.5", "10.20.1.5"]

#     [[box.ftp]]
#     port = 55 # default 21
#     anonymous = true # default false

#         [[box.ftp.file]]
#         name = "memo.txt" # file to retrieve
#         hash = "9d8453505bdc6f269678e16b3e56c2a2948a41f2c792617cc9611ed363c95b63" # sha256 sum to compare to

#         # When multiple files are passed, one is randomly chosen
#         # This pattern persists for any multi-item check
#         [[box.ftp.file]]
#         name = "workfiles.txt" # file to retrieve
#         regex = "work.*work" # regex to test against file
    
#     [[box.imap]]
#     port = 33 # default 143
#     encrypted = true # default false

#     [[box.ldap]]
#     port = 222 # default 636;
#     encrypted = true # default false
#     domain = "sherwood.lan"

#     [[box.ping]]
#     count = 3 # default 1
#     allowpacketloss = true # default false
#     percent = 50 # max percent packet loss

#     # Note: RDP is nonfunctional until a good go RDP library is written, or I write one
#     [[box.rdp]]
#     port = 3389

#     [[box.smb]]
#     credlists = ["admins",] # for any check using credentials, you can specify the list
#     port = 55 # default 21
#     anonymous = true # default false

#         [[box.smb.file]]
#         name = "memo.txt"
#         hash = "9d8453505bdc6f269678e16b3e56c2a2948a41f2c792617cc9611ed363c95b63"

#         [[box.smb.file]]
#         name = "workfiles.txt"
#         regex = "work.*work"

#     [[box.smtp]]
#     encrypted = false # default false
#     sender = "hello@scoring.engine"
#     receiver = "tuck@sherwood.lan"
#     body = "howdy, friar! he's about to have an outlaw for an inlaw!"

#     [[box.sql]]
#     kind = "mysql" # default mysql

#         [[box.sql.query]]
#         contains = true
#         database = "wordpress"
#         table = "users"
#         column = "username"
#         output = "Tuck"
        
#         [[box.sql.query]]
#         database = "squirrelmail"
#         table = "senders"
#         column = "name"
#         output = "Toby Turtle" # Must match exactly

#         [[box.sql.query]]
#         database = "wordpress"
#         databaseexists = true # simply checks if database exists with "show databases;"

#     [[box.ssh]]
#     display = "remote"         # you can set the display name for any check
#     privkey = "village_sshkey" # name of private key in checkfiles/

#     [[box.ssh]]
#     badattempts = 2
#     port = 2222

#         [[box.ssh.command]]
#         command = "cat /etc/passwd"
#         contains = true
#         output = "robin:"

#         [[box.ssh.command]]
#         useregex = true
#         command = "getent `id`"
#         output = '\w.*:[1-9].*:.*'

#     [[box.tcp]] # the most simple check. check tcp connect
#     port = 4444

#     [[box.vnc]]
#     port = 5901

#     [[box.web]]
#     display = "ecom"
#     credlists = ["web",]

#         [[box.web.url]]
#         path = "/joomla"
#         regex = ".*easy to get started creating your website.*"

#         [[box.web.url]]
#         path="/wp-admin.php"
#         usernameparam = "user"
#         passwordparam = "pw"
#         status = 302

#     [[box.web]]
#     port = 8006
#     scheme = "https"
        
#         [[box.web.url]]
#         # defaults to successful page retrieval

#     [[box.winrm]]
#     badattempts = 1
#     encrypted = true

#         [[box.winrm.command]]
#         command = "Get-FileContent memo.txt"
#         contains = true
#         output = "business as usual in the kingdom!"
